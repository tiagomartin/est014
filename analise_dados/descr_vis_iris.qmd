---
title: "Descri√ß√£o e visualiza√ß√£o de dados multivariados utilizando a base Iris"
format:
  html:
    toc: true
    toc-title: "Navega√ß√£o"
    number-sections: true
    df-print: paged
  pdf:
    toc: true
    number-sections: true
    df-print: kable
    documentclass: article
    geometry: margin=1in
    keep-tex: false
editor: visual
execute:
  echo: true
  warning: false
  message: false
  fig-width: 7
  fig-height: 5
  fig-dpi: 300
  fig-path: "figures/"
  # fig-format: "png"   # opcional; descomente se preferir PNG sempre
bibliography: references.bib
---

# Introdu√ß√£o

A base ***iris*** (@fisher1936) √© um dos conjuntos de dados mais cl√°ssicos e did√°ticos da estat√≠stica. Ela cont√©m **150 observa√ß√µes** (flores) de **tr√™s esp√©cies**, *setosa*, *versicolor* e *virginica*, medidas em **quatro vari√°veis cont√≠nuas**:

-   `Sepal.Length` (cm)\
-   `Sepal.Width` (cm)\
-   `Petal.Length` (cm)\
-   `Petal.Width` (cm)


![](/images/iris.jpg){fig-align="center" width=700}

Nosso objetivo √© revisar **conceitos fundamentais de Estat√≠stica Multivariada**:\

- Vetor de m√©dias\
- Matrizes de covari√¢ncia e correla√ß√£o\
- Vari√¢ncia total e generalizada\
- Matrizes de dist√¢ncia (euclidiana e de Mahalanobis)\
- Visualiza√ß√µes (pares, correlograma, heatmaps)


------------------------------------------------------------------------

# Prepara√ß√£o e inspe√ß√£o dos dados

```{r}
# Pacotes necess√°rios
# install.packages(c("tidyverse","GGally","ggcorrplot","pheatmap","factoextra", "MatchIt"))

library(tidyverse)
library(GGally)
library(ggcorrplot)
library(pheatmap)
library(factoextra)
library(MatchIt)

# Carregar a base iris
dados <- iris
glimpse(dados)
summary(dados)

# Parte num√©rica e vari√°vel categ√≥rica
X <- as_tibble(dados[, 1:4])
y <- dados$Species
```


> üí° **Interpreta√ß√£o:** A base iris possui 150 observa√ß√µes e 5 vari√°veis, sendo quatro cont√≠nuas, `Sepal.Length`, `Sepal.Width`, `Petal.Length` e `Petal.Width` (em cent√≠metros) e uma categ√≥rica, `Species`, com tr√™s esp√©cies (`setosa`, `versicolor` e `virginica`). O resumo descritivo da base `iris` indica amostra balanceada por esp√©cie (50 `setosa`, 50 `versicolor`, 50 `virginica`) e sugere padr√µes distintos entre s√©palas e p√©talas: `Sepal.Length` (4,3‚Äì7,9; Q1=5,1; mediana=5,8; m√©dia‚âà5,84) e `Sepal.Width` (2,0‚Äì4,4; Q1=2,8; mediana=3,0; m√©dia‚âà3,06) mostram varia√ß√£o moderada e distribui√ß√£o quase sim√©trica (m√©dias pr√≥ximas √†s medianas), enquanto `Petal.Length` (1,0‚Äì6,9; Q1=1,6; mediana=4,35; m√©dia‚âà3,76) e `Petal.Width` (0,1‚Äì2,5; Q1=0,3; mediana=1,3; m√©dia‚âà1,20) exibem maior dispers√£o e assimetria √† esquerda, refletindo a presen√ßa de muitas p√©talas pequenas (t√≠picas de `setosa`) e valores maiores nas demais esp√©cies; isso cria um perfil ‚Äúbimodal‚Äù nas p√©talas, que costuma discriminar fortemente as esp√©cies, ao passo que as medidas de s√©pala contribuem de forma mais moderada para a separa√ß√£o.



------------------------------------------------------------------------

# Vetor de m√©dias

```{r}
# Vetor de m√©dias global
media_global <- colMeans(X)
media_global

# Vetor de m√©dias por esp√©cie
media_por_especie <- X %>%
  mutate(Species = y) %>%
  group_by(Species) %>%
  summarise(across(everything(), mean), .groups = "drop")
media_por_especie
```

> üí° **Interpreta√ß√£o:** o vetor de m√©dias representa o ‚Äúcentro‚Äù da nuvem de pontos. Comparar m√©dias por esp√©cie ajuda a perceber separa√ß√µes entre grupos (por exemplo, p√©talas maiores em `virginica`). Os valores  mostram o padr√£o cl√°ssico da iris: `setosa` tem p√©talas bem menores (PL=1,462; PW=0,246) e s√©palas relativamente mais largas (SW=3,428), al√©m de menor comprimento de s√©pala (SL=5,006); `virginica` apresenta as maiores p√©talas (PL=5,552; PW=2,026) e o maior comprimento de s√©pala (SL=6,588), com largura de s√©pala intermedi√°ria (SW=2,974); `versicolor` fica entre as duas em todas as medidas (PL=4,260; PW=1,326) e tem a menor largura de s√©pala (SW=2,770). 

------------------------------------------------------------------------

# Matrizes de covari√¢ncia e correla√ß√£o

```{r}
# Matriz de covari√¢ncias
S <- cov(X)
S
```

> üìà **Covari√¢ncia:** mede associa√ß√£o linear nas unidades originais. As vari√¢ncias (diagonal) indicam que a maior dispers√£o est√° em `Petal.Length` (3.1163), seguida de `Sepal.Length` (0.6857) e `Petal.Width` (0.5810), enquanto `Sepal.Width` varia menos (0.1900). Nos termos cruzados, h√° covari√¢ncia positiva forte entre `Petal.Length` e `Petal.Width` (1.2956), e tamb√©m entre `Sepal.Length` com `Petal.Length` (1.2743) e com `Petal.Width` (0.5163); j√° `Sepal.Width` apresenta covari√¢ncias negativas com as demais (especialmente com `Petal.Length`: ‚àí0.3297).


```{r}
# Matriz de correla√ß√µes
R <- cor(X)
R
```

> üìä **Correla√ß√£o:** padroniza a covari√¢ncia (-1 a 1), √∫til quando vari√°veis t√™m escalas diferentes. A matriz de correla√ß√µes da iris mostra que as medidas de p√©tala s√£o fortemente associadas: `Petal.Length` e `Petal.Width` t√™m correla√ß√£o muito alta (0,963) e ambas se correlacionam bastante com `Sepal.Length` (0,872 e 0,818), indicando forte redund√¢ncia informacional entre essas vari√°veis; j√° `Sepal.Width` se relaciona negativamente com as demais (‚àí0,118 com `Sepal.Length`, ‚àí0,428 com `Petal.Length` e ‚àí0,366 com `Petal.Width`), sugerindo um padr√£o em dire√ß√£o oposta. Em s√≠ntese, as p√©talas dominam a varia√ß√£o e separam melhor as esp√©cies, enquanto `Sepal.Width` adiciona informa√ß√£o complementar (e contr√°ria), com alerta para poss√≠vel multicolinearidade entre as medidas de p√©tala.

------------------------------------------------------------------------

# Vari√¢ncia generalizada e total

```{r}
# Vari√¢ncia generalizada (determinante de S)
eigen(S)
VG <- det(S)
VG
```

> üì¶ **VG (determinante):** A vari√¢ncia generalizada 0,00191273 √© o determinante da matriz de covari√¢ncias **S** e mede o ‚Äúvolume‚Äù da dispers√£o conjunta; um valor t√£o pequeno indica forte colinearidade/redund√¢ncia entre as vari√°veis, especialmente entre `Petal.Length` e `Petal.Width`, de modo que a nuvem de pontos fica ‚Äúachatada‚Äù em algumas dire√ß√µes (um ou mais autovalores de **S** s√£o pequenos, e o produto deles, o determinante, cai). Em termos pr√°ticos, isso sugere que as medidas de p√©tala carregam informa√ß√£o muito semelhante.


```{r}
# Vari√¢ncia total (tra√ßo de S)
VT <- sum(diag(S))
VT
```

> üßÆ **VT (tra√ßo):** soma das vari√¢ncias marginais = dispers√£o total marginal. Ela mede a dispers√£o global do conjunto e √© dependente de escala; padronizando as vari√°veis (z-scores), a vari√¢ncia total passaria a ser $p = 4$. Pela decomposi√ß√£o: `Petal.Length` responde por aproximadamente 68,1% da vari√¢ncia total, `Sepal.Length` responde por 15,0%, `Petal.Width`  por 12,7% e `Sepal.Width` por 4,2%, confirmando que as medidas de p√©tala dominam a variabilidade. 


------------------------------------------------------------------------

# Matrizes de dist√¢ncia

## Dist√¢ncia Euclidiana

```{r}
D_euclid <- euclidean_dist(data = X)
as.matrix(D_euclid)[1:6, 1:6]
```

> üìè Dist√¢ncia Euclidiana representa a dist√¢ncia geom√©trica entre dois pontos.

## Dist√¢ncia de Karl Pearson

```{r}
D_karlP <- scaled_euclidean_dist(data = X)
as.matrix(D_karlP)[1:6, 1:6]
```

> üìè Dist√¢ncia de Karl Pearson leva em conta as diferen√ßas de escala.

## Dist√¢ncia de Mahalanobis

```{r}
D_mahal <- mahalanobis_dist(data = X)
as.matrix(D_mahal)[1:6, 1:6]
```

> üìè Dist√¢ncia de Mahalanobis leva em conta correla√ß√µes entre vari√°veis e diferen√ßas de escala.

------------------------------------------------------------------------

# Visualiza√ß√µes b√°sicas

## Gr√°fico de pares por esp√©cie

```{r}
GGally::ggpairs(bind_cols(X, Species = y),
                columns = 1:4, aes(color = Species, alpha = 0.8)) + theme_bw()
```

> üí° **Interpreta√ß√£o:**  O ‚Äúpairs plot‚Äù da iris mostra que `setosa` tem p√©talas muito pequenas e s√©palas mais largas, enquanto `versicolor` e `virginica` apresentam p√©talas maiores (com alguma sobreposi√ß√£o), e em `Sepal.Width` a esp√©cie `setosa` desloca-se √† direita, `versicolor` √† esquerda e `virginica` fica intermedi√°ria. As correla√ß√µes globais destacam `Petal.Length` *vs.* `Petal.Width` como fort√≠ssima (‚âà0,96) e `Sepal.Length` bem associado √†s p√©talas; j√° `Sepal.Width` aparece negativamente correlacionado no agregado. Contudo, por esp√©cie as rela√ß√µes com `Sepal.Width` tendem a ser positivas, e os dispersogramas envolvendo medidas de p√©tala exibem a melhor separa√ß√£o entre esp√©cies. Em s√≠ntese, as p√©talas dominam a estrutura e a discrimina√ß√£o, com `Sepal.Width` fornecendo informa√ß√£o complementar.



## Correlograma

```{r}
ggcorrplot(R, hc.order = TRUE, type = "lower",
           lab = TRUE, tl.cex = 10,
           title = "Matriz de Correla√ß√µes - iris")
```

> üí° **Interpreta√ß√£o:** O mapa de correla√ß√µes da iris evidencia tr√™s padr√µes centrais: (1) forte associa√ß√£o positiva entre as medidas de p√©tala: `Petal.Length` *vs.* `Petal.Width` ‚âà 0,96 e tamb√©m de `Sepal.Length` com as p√©talas (‚âà 0,87 e 0,82), indicando redund√¢ncia informacional e prov√°vel multicolinearidade; (2) `Sepal.Width` apresenta correla√ß√µes negativas com as demais vari√°veis (‚âà ‚àí0,12 com `Sepal.Length`, ‚àí0,43 com `Petal.Length` e ‚àí0,37 com `Petal.Width`), sugerindo um eixo de varia√ß√£o em sentido oposto ao das p√©talas; e (3) como consequ√™ncia, em tarefas de PCA ou classifica√ß√£o, as p√©talas tendem a dominar a separa√ß√£o entre esp√©cies, enquanto `Sepal.Width` adiciona sinal complementar.


## Heatmap das correla√ß√µes

```{r}
pheatmap(R, cluster_rows = TRUE, cluster_cols = TRUE,
         main = "Heatmap da Matriz de Correla√ß√µes (iris)")
```

> üí° **Interpreta√ß√£o:** O heatmap das correla√ß√µes da iris confirma dois blocos de vari√°veis: (i) `Petal.Length` e `Petal.Width` fortemente positivas entre si (vermelho intenso) e tamb√©m bem alinhadas com `Sepal.Length` (vermelho), formando um grupo altamente correlacionado que indica redund√¢ncia e tende a dominar a varia√ß√£o; (ii) `Sepal.Width` aparece em azul frente √†s demais, mostrando correla√ß√£o negativa moderada, o que a isola no dendrograma e sugere um eixo complementar de informa√ß√£o. Em termos pr√°ticos, as p√©talas s√£o as melhores para discriminar esp√©cies (e podem sofrer multicolinearidade), enquanto `Sepal.Width` acrescenta sinal em dire√ß√£o oposta.


# Refer√™ncias Bibliogr√°ficas

::: {#refs}
:::
